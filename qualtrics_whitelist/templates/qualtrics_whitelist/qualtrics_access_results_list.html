{% extends "qualtrics_whitelist/base.html" %}
{% load crispy_forms_tags %}
{% load static %}


{% block title %}Results List{% endblock %}
{% block pagetitle %}Results List{% endblock %}


{% block content %}
<h4>Choose one or more and enter the reason and access end date, if necessary</h4>


<form name="form1" id="checkboxForm" action="./" method="POST">{% csrf_token %}
<input type="hidden" name="user_id" value="{{ user_input }}" >
<input type="hidden" name="users_list" value="{{ results_list }}" >

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<table border="2">
	<thead>
        <tr>
        	<th></th>
            <th>Role Type</th>
            <th>HUID</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Email</th>
        </tr>
    </thead>
    <tbody>
    {% if results_list %}
		{% for choice in results_list %}
			<tr>
			{% if choice.on_list %}
				<td>Already Added</td>
			{% else %}	
				<td><input type="checkbox" name="user_check_list" id="checkbox" value="{{choice.user_id}}" class="checkbox"></td>
			{% endif %}
				<td>{{ choice.role_type }}</td>
				<td>{{ choice.user_id }}</td>
				<td>{{ choice.first_name }}</td>
				<td>{{ choice.last_name }}</td>
				<td>{{ choice.email }}</td>
			</tr>
		{% endfor %}
	{% endif %}
	<tbody>
</table>
<br>
<table>
	<tr>
		<td>Enter Reason Description:</td><td><input type="text" name="description" ></td>
	</tr>
	<tr>
		<td>Enter Access End Date:</td><td><input type="text" class="dateinput" name="access_end_date"</td>
	</tr>
	<tr>
		<td/>
		<td>
			<!-- <input type="submit" class="delete" name="Save" value="Save" id="saveBtn" onclick="return checkReason()" disabled> -->
			<button id="sub" class="btn btn-primary" type="submit" onclick="return checkReason()"  name="Save" disabled="disabled" >Save Button</button>
			<!-- <input type="submit" class="btn btn-primary" name="Cancel" value="Cancel" id="cancel"> -->
			<button class="btn btn-primary" type="submit" name="Cancel">Cancel</button>
		</td>
	<tr>
</table>
</form>


{% endblock %}


{% block javascript %}
{{ block.super }}
<script>

$(document).ready(function() { 
	$('.dateinput').datepicker();
});

$('.checkbox').change(function() {
    if ($('.checkbox:checked').length) {
        $('#sub').removeAttr('disabled');
    } else {
        $('#sub').attr('disabled', 'disabled');
    }
});


function checkReason()
{
	if (!form1.description.value)
	{
		alert ("Please Enter a Reason description.");
		return false;
	}
	return true;
}
	
</script>

{% endblock %}