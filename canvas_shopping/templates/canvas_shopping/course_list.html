{% extends "canvas_shopping/base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block title %}Canvas Courses for {{ school.title_short }}{% endblock %}
{% block page_title %}Canvas Courses for {{ school.title_short }}{% endblock %}

{% block breadcrumb %}
<ul class="breadcrumb">
    <li><a href="{% url 'sh:schoollist' %}">Schools</a></li>
    <li class="active"><a href="#">{{ school.title_short }} Courses</a></li>
</ul>
{% endblock %}


{% block content %}
{% if course_list %}
<h1>Canvas Courses for {{ school.title_short }}</h1>
<table class="table">
    {% for course_instance_id, course in course_list.items %}
        <tr>
            <td>
                {{ school.school_id|upper }}-{{ course.instance.course.registrar_code }}</td><td>{{ course.instance.title }}
            </td>
            <td>
                {% if course.enrollee %}
                    <a href="{{ canvas_base_url }}/courses/{{ course.instance.canvas_course_id }}" class="btn btn-primary"><i class="fa fa-arrow-right"></i> Visit course website</a>
                {% endif %}
            </td>
            {% if course.enrollee %}
            <td>
                <form method="POST" action="{% url 'sh:remove_shopper_ui' %}">{% csrf_token %}
                    <input type="hidden" name="canvas_course_id" value="{{course.instance.canvas_course_id}}"/>
                    <input type="hidden" name="canvas_enrollee_id" value="{{ course.enrollee.id }}"/>
                    <input type="hidden" name="school_id" value="{{school.school_id}}"/>
                    <button type="submit" class="btn btn-default" data-loading-text="Removing..."><i class="fa fa-sign-out fa-fw"></i> Leave this course</button>
                </form>
            </td>
            {% else %}
            <td>
                <form method="POST" action="{% url 'sh:add_shopper_ui' %}">{% csrf_token %}
                    <input type="hidden" name="course_instance_id" value="{{course_instance_id}}"/>
                    <input type="hidden" name="school_id" value="{{school.school_id}}"/>
                    <button type="submit" class="btn btn-success" data-loading-text="Adding..."><i class="fa fa-shopping-cart fa-fw"></i> Shop this course</button>
                </form>
            </td>
            {% endif %}
        </tr>
    {% endfor %}
</table>

{% endif %}


{% endblock %}
