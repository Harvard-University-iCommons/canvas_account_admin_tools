{% extends "term_tool/base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block page_title %}{{ school.school_id|upper }} Terms{% endblock %}


{% block breadcrumb %}
<ul class="breadcrumb">
    <li><a href="{% url "tt:schoollist" %}">Schools</a></li>
    <li class="active"><a href="#">{{ school.school_id|upper }} Terms</a></li>
</ul>
{% endblock %}


{% block content %}

{% if term_list %}
{% if AUTHORIZEDTOEDIT %}
    <a href="{% url "tt:termcreate" school_id=school.school_id %}" class="btn btn-success">
        <i class="icon-plus"></i> Create a new {{ school.school_id|upper }} term</a>
{% endif %}



<table class="table table-striped">
    <thead>
        <tr>
            <th>Display Name</th>
            <th>Academic Year</th>
            <th>Disable Auth User Param</th>
            <th>Start Date</th>
            <th>End Date</th> 
            <th>Xreg Start Date</th>
            <th>Xreg End Date</th> 
        </tr>
    </thead>
    <tbody>
    {% for term in term_list %}

        {% if school.school_id == 'sum' or school.school_id == 'ext' or term.xreg_available == 0 %}
            {% if term.start_date == None or term.end_date == None %}
                <tr class="error">
            {% else %}
                <tr>
            {% endif %}

        {% else %}
            {% if term.start_date == None or term.end_date == None or term.xreg_start_date == None or term.xreg_end_date == None %}
                <tr class="error">
            {% else %}
                <tr>
            {% endif %}
        {% endif %}

        {% if AUTHORIZEDTOEDIT %}
                <td>
                    <a href="{% url "tt:termedit" pk=term.term_id %}">{{ term.display_name|default:term.term_id }}</a>
                </td>
        {% else %}
                <td>
                    {{ term.display_name|default:term.term_id }}
                </td>    
        {% endif %}
        
        
            <td>
                {{ term.academic_year }}
            </td>
            <td>
                {% if term.shopping_active %}
                    <a href="{% url "tt:excludecourses" term_id=term.term_id school_id=school.school_id %}">update courses</a>
                {% endif %}
            </td>
            <td>
                {% if term.start_date == None %}<span class="label label-danger"><i class="fa fa-exclamation-triangle"></i></span>{% endif %}
                {{ term.start_date|date }}
            </td>
            <td>
                {% if term.end_date == None %}<span class="label label-danger"><i class="fa fa-exclamation-triangle"></i></span>{% endif %}
                {{ term.end_date|date }}
            </td>

            {% if school.school_id == 'sum' or school.school_id == 'ext' or term.xreg_available == 0 %}
                <td>
                    <span class="label label-default">n/a</span>
                    {{ term.xreg_start_date|date }}
                </td>
                <td>
                    <span class="label label-default">n/a</span>
                    {{ term.xreg_end_date|date }}
                </td>
            {% else %}
                <td>
                    {% if term.xreg_start_date == None %}<span class="label label-danger"><i class="fa fa-exclamation-triangle"></i></span>{% endif %}
                    {{ term.xreg_start_date|date }}
                </td>
                <td>
                    {% if term.xreg_end_date == None %}<span class="label label-danger"><i class="fa fa-exclamation-triangle"></i></span>{% endif %}
                    {{ term.xreg_end_date|date }}
                </td>
            {% endif %}


        </tr>
    {% endfor %}
    </tbody>

</table>



{% endif %}

    <ul class="pagination">
        {% if page_obj.has_previous %}
        <li><a href="?page={{ page_obj.previous_page_number }}"> <i class="fa fa-chevron-left"></i> </a></li>
        {% else %}
        <li class="disabled"><a href="#"> <i class="fa fa-chevron-left"></i> </a></li>
        {% endif %}

        {% for page_num in paginator.page_range %}
        <li {% if page_num == page_obj.number%} class="active" {% endif %}>
            <a href="?page={{ page_num }}">{{ page_num }}</a>
        </li>

        {% endfor %}

        {% if page_obj.has_next %}
            <li><a href="?page={{ page_obj.next_page_number }}"> <i class="fa fa-chevron-right"></i> </a></li>
        {% else %}
            <li class="disabled"><a href="#"> <i class="fa fa-chevron-right"></i> </a></li>
        {% endif %}

    </ul>


{% endblock content %}
