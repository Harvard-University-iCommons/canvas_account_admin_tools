{% extends "course_conclusion/base.html" %}
{% load static %}

{% block page_title %}Course Conclusion Dates{% endblock page_title %}

{% block bodytag %}
<body class="with-navbar" ng-app="courseConclusionApp">
{% endblock bodytag %}

{% block content %}
{% verbatim form %}
<!-- TODO - form validation before submit --!>
<form novalidate class="form-horizontal" name="courseConcludeForm"
      ng-controller="CourseConclusionController as courseCtrl"
      ng-submit="courseCtrl.submit(courseConcludeForm)">

  <div class="col-sm-offset-2 col-sm-10">
    <alert ng-repeat="alert in courseCtrl.alerts" type="{{alert.type}}"
           close="courseCtrl.closeAlert($index)">
      {{alert.msg}}
    </alert>
  </div>

  <div class="form-group">
    <label for="school" class="col-sm-2 control-label">School</label>
    <div class="col-sm-10">
      <select class="form-control" name="school" required
              ng-options="school.title_short for school in courseCtrl.schools"
              ng-model="courseCtrl.currentSchool"
              ng-change="courseCtrl.getTerms()"
              ng-disabled="courseCtrl.schools.length === 0">
        <option value="">-- Choose A School --</option>
      </select>
    </div>
  </div>

  <div class="form-group">
    <label for="term" class="col-sm-2 control-label">Term</label>
    <div class="col-sm-10">
      <select class="form-control" name="term" required
              ng-options="term.display_name for term in courseCtrl.terms"
              ng-model="courseCtrl.currentTerm"
              ng-change="courseCtrl.getCourses()"
              ng-disabled="courseCtrl.terms.length === 0">
        <option value="">-- Choose A Term --</option>
      </select>
    </div>
    <div class="col-sm-10 col-sm-offset-2 text-muted"
         ng-show="courseCtrl.currentTerm.conclude_date">
      Term conclude date is {{ courseCtrl.currentTerm.conclude_date | date }}
    </div>
  </div>

  <div class="form-group">
    <label for="course" class="col-sm-2 control-label">Course</label>
    <div class="col-sm-10">
      <select class="form-control" name="course" required
              ng-options="course.course_id + ' - ' + (course.title || 'No title') for course in courseCtrl.courses"
              ng-model="courseCtrl.currentCourse"
              ng-disabled="courseCtrl.courses.length === 0">
        <option value="">-- Choose A Course --</option>
      </select>
    </div>
  </div>

  <div class="form-group">
    <label for="course-conclusion-date" class="col-sm-2 control-label">
      Course Conclusion Date
    </label>
    <div class="col-sm-10">
      <input type="date" class="form-control" name="courseConcludeDate"
             ng-model="courseCtrl.currentCourse.conclude_date"
             ng-disabled="!courseCtrl.currentCourse">
    </div>
  </div>

  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-default"
              ng-disabled="courseConcludeForm.$invalid">Submit</button>
      <button type="reset" class="btn btn-default">Reset</button>
    </div>
  </div>

{% endverbatim form %} <!-- end inside the form so we can get the csrf token --!>
  {% csrf_token %}
</form>
{% endblock content %}

{% block javascript %}
{{ block.super }}
{% if debug %}
<script src="{% static "angular-1.4.0/angular.js" %}"></script>
<script src="{% static "js/ui-bootstrap-tpls-0.13.0.js" %}"></script>
{% else %}
<script src="{% static "angular-1.4.0/angular.min.js" %}"></script>
<script src="{% static "js/ui-bootstrap-tpls-0.13.0.min.js" %}"></script>
{% endif %}
<script src="{% static "course_conclusion/index.js" %}"></script>
{% endblock javascript %}
