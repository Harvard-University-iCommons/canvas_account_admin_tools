{% extends 'bulk_course_settings/base.html' %}

{% block js %}
    <script>
		$(document).ready(function() {
			$('.datatable').dataTable( {
				aaSorting: [[0, 'desc']],
				"aoColumnDefs": [ {
					'bSortable': false,
					'aTargets': [3] } ],
				"oLanguage": {
                  "sSearch": "Search"
                }
			});
		});
	</script>
{% endblock js %}

{% block body %}
<body role="application">
    <div class="container">
        <header>
            <h3 class="breadcrumbs">
                <a href="{% url 'dashboard_account' %}">Admin Console</a>
                <small><i class="fa fa-chevron-right"></i></small>
                Manage Bulk Course Settings
            </h3>
        </header>
        {% for message in messages %}
            <div class="alert alert-success" role="alert">
                {{ message }}
            </div>
        {% endfor %}
        <div class="row">
            <h4>Set Bulk Course settings </h4>
            <div align="right">
                <a href="{% url 'bulk_course_settings:create_new_setting' %}" class="btn btn-primary">Create New Setting</a>
            </div>
        </div>
        <div class="row"><h4>Audit Log:</h4></div>
        <table class="datatable table table-striped table-bordered">
            <thead>
                <th>Job ID</th>
                <th>Term</th>
                <th>Setting Modified</th>
                <th>Desired Setting</th>
                <th>Status</th>
                <th>Total</th>
                <th>Success</th>
                <th>Failed</th>
                <th>Skipped</th>
            </thead>
            <tbody>
            {% for job in jobs %}
                <tr>
                    <td><a href="{% url 'bulk_course_settings:bulk_settings_job_audit' job_id=job.id %}"> {{ job.id }} </a> </td>
                    <td>{{ job.get_term_name }}</td>
                    <td>{{ job.get_setting_to_be_modified_display }}</td>
                    <td>
                        {% if job.related_job_id is None %}
                            {{ job.get_desired_setting_display }}
                        {% else %}
                            Reversion
                        {% endif %}
                    </td>
                    <td>{{ job.get_workflow_status_display }}</td>
                    <td>{{ job.details_total_count}}</td>
                    <td>{{ job.details_success_count }}</td>
                    <td>{{ job.details_failed_count }}</td>
                    <td>{{ job.details_skipped_count }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</body>
{% endblock body %}
